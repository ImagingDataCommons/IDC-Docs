#### 4.1.2 Data Organization
Publicly available IDC data in GCS is stored in two different locations. Currently, the majority of data is hosted 
in the Google Public Dataset Program (PDP), though some data (e.g. collections with commercial use restrictions) are 
held back and hosted in an IDC-owned project, which is distinct from the production project hosting IDC services
such as the WebApp, API, and Proxy. By storing data in a distinct project, one retains the option of pulling the 
billing account off of the separate production system project as a last-ditch “nuclear option” to bring the 
system down (a procedure that puts all associated storage at risk of deletion while the billing account is missing).
 
IDC originally ensured that egress costs would not be borne by the IDC, by configuring all storage buckets 
as Google “requester pays”. This meant that users needed to be logged in to Google, and needed to provide a project 
ID to be charged for any egress costs. However, since the data is now split between the Google PDP and the IDC 
project, the requester pays requirement has been removed from IDC resources. This is done because if the user was 
accessing data from a mixture of requester-pays and free download buckets (the Google PDP), they would be charged 
for the free downloads unless they were careful to provide a billing project only when they were reading from the 
requester-pays bucket, and not when reading from the free bucket. 

Given that the DICOM data model is centered on a collection/case/study/series hierarchy, it would be logical to
organize the IDC DICOM files in a folder hierarchy that matches this model. However, the requirements of versioning
the data makes an efficient multi-level-hierarchy difficult to achieve. Thus, the files are all stored in a small set
of storage buckets that are divided based on licensing and access requirements. Within those few buckets, a flat
address space is used. Researchers can reassemble the hierarchies on local file systems, if they choose, as they
pull the files from the buckets.

More recently, to support gfs-based tools to access files, IDC has been preparing to migrate to a shallow 
hierarchy that places all the series instances in a single folder. This transition is a work in progress.

The IDC uses the Data Commons Framework IndexD/DRS service that maps file UUIDs to the actual URIs. This mapping of 
UUIDs to URIs is generated by IDC for all new data files, and is provided in BigQuery tables. This means the IDC can 
provide these URLs without needing to use IndexD/DRS.

